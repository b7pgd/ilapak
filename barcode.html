<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Generator Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 50px; 
            background: #f4f4f9; 
        }
        .card { 
            background: white; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
            text-align: center;
            width: 500px; /* Gue lebarin dikit biar muat checkbox */
        }
        h2 { color: #333; margin-bottom: 20px; }
        
        .input-wrapper { 
            margin-bottom: 15px; 
            display: flex; 
            gap: 10px; 
            justify-content: center; 
            align-items: center; 
        }
        input.userInput { 
            padding: 12px; 
            width: 55%; 
            border: 2px solid #ddd; 
            border-radius: 8px; 
            outline: none;
        }

        /* Styling Checkbox & Label */
        .show-text-label { font-size: 12px; display: flex; flex-direction: column; align-items: center; color: #666; }
        .show-text-label input { width: 18px; height: 18px; cursor: pointer; }
        
        /* Tombol + dan - dengan isi simbol yang besar */
        .btn-action { 
            font-size: 24px; /* Simbol diperbesar */
            font-weight: bold;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            width: 50px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
        }
        .btn-plus { background: #28a745; }
        .btn-minus { background: #ff4d4d; }
        .btn-action:hover { opacity: 0.8; }
        
        button.main-btn { 
            padding: 12px 25px; 
            background: #007bff; 
            color: white; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: bold;
            width: 90%;
            margin-top: 10px;
            font-size: 16px;
        }
        .btn-pdf { background: #dc3545; }

        /* Container Hasil di Web (Persis A4) */
        #print-area { 
            margin-top: 30px; 
            display: flex; 
            flex-wrap: wrap; 
            width: 210mm; 
            background: white;
            padding: 10mm;
            justify-content: flex-start;
        }
        .barcode-box { 
            width: 45%; 
            margin: 10px;
            text-align: center;
            border: 1px dashed #ccc;
            padding: 10px;
        }
    </style>
</head>
<body>

    <div class="card">
        <h2>Barcode Generator</h2>
        
        <div id="input-container">
            <div class="input-wrapper">
                <input type="text" class="userInput" placeholder="Masukkan nama atau angka...">
                <label class="show-text-label">
                    <input type="checkbox" class="showText" checked>
                    Teks
                </label>
                <button class="btn-action btn-plus" onclick="addInput()">+</button>
            </div>
        </div>

        <button class="main-btn" onclick="generateBarcodes()">Generate Barcode</button>
        <button class="main-btn btn-pdf" onclick="downloadPDF()">Download PDF</button>

        <div id="print-area"></div>
    </div>

    <script>
        // Fungsi tambah kolom input
        function addInput() {
            const container = document.getElementById('input-container');
            const div = document.createElement('div');
            div.className = 'input-wrapper';
            div.innerHTML = `
                <input type="text" class="userInput" placeholder="Masukkan nama atau angka...">
                <label class="show-text-label">
                    <input type="checkbox" class="showText" checked>
                    Teks
                </label>
                <button class="btn-action btn-minus" onclick="this.parentElement.remove()">-</button>
            `;
            container.appendChild(div);
        }

        function generateBarcodes() {
            const wrappers = document.querySelectorAll('.input-wrapper');
            const printArea = document.getElementById('print-area');
            printArea.innerHTML = ''; 

            wrappers.forEach((wrapper, index) => {
                const val = wrapper.querySelector('.userInput').value.trim();
                const isShowText = wrapper.querySelector('.showText').checked;

                if (val) {
                    const box = document.createElement('div');
                    box.className = 'barcode-box';
                    
                    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                    svg.id = "barcode-" + index;
                    box.appendChild(svg);
                    printArea.appendChild(box);

                    // Generate Barcode
                    JsBarcode("#barcode-" + index, val, {
                        format: "CODE128",
                        lineColor: "#000",
                        width: 2,
                        height: 80,
                        displayValue: isShowText // Mengikuti opsi checkbox user
                    });
                }
            });
        }

        async function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const element = document.getElementById('print-area');
            
            if (element.children.length === 0) {
                alert("Generate dulu, Bang!");
                return;
            }

            const canvas = await html2canvas(element, { scale: 2 });
            const imgData = canvas.toDataURL('image/png');
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const imgProps = pdf.getImageProperties(imgData);
            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            pdf.save("barcode-list.pdf");
        }
    </script>

</body>
</html>